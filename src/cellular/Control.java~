package cellular;

import java.util.Scanner;

import java.util.Map;
import java.util.HashMap;
public class Control
{
	private static Map<String, Program> programs;
	public static void main()
	{
		programs = new HashMap<String, Program>();
		FilingCabinet filer = new FilingCabinet("text/");
		filer.printFile("welcome.txt");
		String[] commands = new String[10];
		commands[0] = "";
		while (!commands[0].equals("exit"))
		{
			// Clear the commands array.
			for (int i = 0; i < 10; i++)
			{
				commands[i] = null;	
			}
			// Ask for commands
			System.out.print("Command: ");
			Scanner scan = new Scanner(System.in);
			String line = scan.nextLine();
			Scanner reader = new Scanner(line);
			// Record the commands
			int index = -1;
			while (reader.hasNext())
			{
				index++;
				commands[index] = reader.next();
			}
			if (commands[0] == null
				|| commands[0] == "")
			{
				continue;
			}
			// Interpret the commands into action
			if (commands[0].equals("createBox"))
			{
				if (index < 4)
				{
					System.out.println("Not enough arguments!");
				}
				else
				{
					createBox(commands);
				}
			}
			else if (commands[0].equals("createProgram"))
			{
				if (index < 2)
				{
					System.out.println("Not enough arguments!");
				}
				else
				{
					createProgram(commands);
				}
			}
			else if (commands[0].equals("run"))
			{
				if (index == 0)
				{
					System.out.println("Specify Name!");
				}
				else if (index == 1)
				{
					System.out.println("Specify Box!");
				}
				else if (index == 2)
				{
					System.out.println("Specify number of ticks!");
				}
				else
				{
					run(commands);
				}
			}
			else if (commands[0].equals("save"))
			{
				if (index < 2)
				{
					System.out.println("Too few arguments!");
				}
				else 
				{
					save(commands);	
				}
			}
			else
			{
				System.out.println("Unrecognized Command!");	
			}
		}
		filer.printFile("exit.txt");
		System.exit(0);
	}
	/**
	 *  Creates a new program and adds it to the list.
	 */
	public static void createProgram(String[] args)
	{
		if (!(args[2].equals("life")
			|| args[2].equals("ant")
			|| args[2].equals("test")
			|| args[2].equals("wire")))
		{
			System.out.println("No automata of that type!");
		}
		else
		{
			if (!programs.containsKey(args[1]))
			{
				Program p = new Program(args[1], args[2]);
				programs.put(args[1], p);
			}
			else
			{
				System.out.println("Already a Program of that name!");
			}
		}
	}
	/**
	 *  Creates a new Box for a given program with a given name.
	 */
	public static void createBox(String[] args)
	{
		System.out.println("Creating New Box...");
		if (programs.containsKey(args[1]))
		{
			Program prgm = programs.get(args[1]);
			int X = Integer.parseInt(args[3]);
			int Y = Integer.parseInt(args[4]);
			prgm.addBox(args[2], X, Y);
		}
		else
		{
			System.out.println("Name taken!");
		}
	}
	/**
	 *  Runs a grid in the specified program.
	 */
	public static void run(String args[])
	{
		if (programs.containsKey(args[1]))
		{
			programs.get(args[1]).run(args[2], Integer.parseInt(args[3]));
		}
		else
		{
			System.out.println("Program not found");
		}
	}
	/**
	 *  Saves a Grid to a file.
	 */
	public static void save(String[] args)
	{
		if (programs.containsKey(args[1]))
		{
			programs.get(args[1]).saveToFile(args[2]); // saveFile could work
		}
		else
		{
			System.out.println("Program not found");
		}
	}
	/**
	 *  Loads a Grid from a file into a new Grid.
	 */
	public static void load(String[] args)
	{
		// Need to work out file format first.
		System.out.println("In Development!");
	}
}